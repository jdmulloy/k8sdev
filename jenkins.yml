master:
  runAsUser: 1000 # dont run Jenkins as root
  fsGroup: 1000 # dont run Jenkins as root
  adminUser: "admin"
  adminPassword: admin

  # The node provisioner args ensure Jenkins doesn't wait forever to start new agents. By default it leans toward preserving resources
  # instead of spinning up new nodes.  Since we are running all our jobs in k8s we want it to spin them up quickly, and be less
  # afraid of over provisioning.
  javaOpts: '-Xmx512m -XshowSettings:vm -Dhudson.slaves.NodeProvisioner.initialDelay=0 -Dhudson.slaves.NodeProvisioner.MARGIN=50 -Dhudson.slaves.NodeProvisioner.MARGIN0=0.85'
  
  jenkinsUrl: "http://k8s.local/jenkins"
  jenkinsUriPrefix: "/jenkins"

  # You still want some executors even if you aren't using them much. Remove this if you want to wait multiple minutes for your
  # builds to start
  numExecutors: 10 
  
  ingress:
    enabled: true
    hostName: k8s.local
    path: /jenkins


  # Setting this to ClusterIP means to reach our Jenkins from outside the cluster
  # we will need to provide an ingress.
  serviceType: "ClusterIP" 
  
  # Enable to always override the installed plugins with the values of 'master.installPlugins' on upgrade or redeployment.
  overwritePlugins: true
    # List of plugins to be install during Jenkins master start
  installPlugins:
    - kubernetes:1.18.1
    - workflow-job:2.33
    - workflow-aggregator:2.6
    - credentials-binding:1.20
    - git:3.11.0
    - job-dsl:1.74
    # if you update this, update plugin version below
    - configuration-as-code:1.27
    - blueocean:1.18.1
    - groovy:2.2
  JCasC:
    enabled: true
    # configuration-as-code version from above
    pluginVersion: "1.27"
    configScripts:
      # If you want to overwrite the message it has to be done in this JCasC script because
      # it is defined in the default values.yml for the chart.
      welcome-message: |
        jenkins:
          systemMessage: Welcome to our CI\CD server.  This Jenkins is configured and managed 'as code'.
      germinate: |
        unclassified:
          gitscm:
            globalConfigName: jenkins
            globalConfigEmail: jenkins@domain.local
            createAccountBasedOnEmail: false
        security:
          globalJobDslSecurityConfiguration:
            useScriptSecurity: false
        jobs:
          - script: >
              job('Seed Job') {
                  scm {
                      git('git://github.com/coryleeio/testdsl.git')
                  }
                  triggers {
                      scm('H/15 * * * *')
                  }
                  steps {
                      systemGroovyScriptFile('Folders.groovy') {
                      }
                      systemGroovyScriptFile('Secrets.groovy') {
                      }
                      dsl {
                          external('jobs/*.groovy')
                          removeAction('DELETE')
                      }
                  }
              }
agent:
  enabled: true
  image: "jenkins/jnlp-slave"
  tag: "3.29-1-alpine"
  resources:
    requests:
      cpu: "200m"
      memory: "256Mi"
    limits:
      cpu: "200m"
      memory: "1024Mi"